[AZT304.md](https://github.com/user-attachments/files/22000774/AZT304.md)
# AZT304 - Hijack Azure Machine Learning Notebooks (via Storage Accounts)

> Note: **AZT304** follows the Execution tactic numbering. Maintainers may still renumber or relocate this entry.

An adversary may achieve **code execution** in Azure Machine Learning (AML) by modifying Jupyter **notebook files** stored in the AML workspace’s **backing Storage Account (Azure Files “code” share)**. AML Studio maps this file share directly to the notebook UI. If an attacker has **read/write access** to that Storage Account (e.g., via RBAC or account keys), they can inject hidden or overt code cells into `.ipynb` files. Execution occurs when users click **Run all** or when notebooks run as part of **pipelines/scheduled jobs**, yielding code execution within AML compute.

A now-remediated issue previously allowed the **Reader** role on AML to obtain **Storage Account keys** for the workspace’s default datastore endpoints, enabling notebook modification and execution. Public tooling also enables dumping AML datastore credentials from the management plane, facilitating further credential access.

ID | Name | Description | Action | Resources
---|---|---|---|---
AZT304.1 | Storage Account Notebook Overwrite | Modify `.ipynb` files in the AML workspace’s Storage Account (Azure Files) to inject code that executes in user sessions or pipelines. | N/A (data plane file write) | Machine Learning, Storage Account (Azure Files)
